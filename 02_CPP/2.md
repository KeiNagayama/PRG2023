# Part2: 標準ライブラリ

C++には標準ライブラリとして様々な機能が使えるようになっています．

- 文字列：string
- 入出力：iostream, fstream
- コンテナ：vector, map, set, queue, stack, pair, tuple
- 数値計算：cmath, random
- アルゴリズム：sort, unique, reverse

## Hello world! 再訪

Part 1 のはじめに登場した Hello world! のプログラムをもう一度見てみましょう．

```c++
#include <iostream> // 標準入出力ライブラリを取り込む（使えるようにする）

int main()
{
    std::cout << "Hello world!" << std::endl;
    return 0;
}
```

C++の標準ライブラリの機能は `std` という箱の中に入っています．この箱の名前が名前空間 (namespace) で，`std` は標準ライブラリの名前空間です．`std::` をつけることで標準ライブラリの中の機能を使うことを明示します．

C++ の標準ライブラリは，名前空間 `std` のなかで，機能ごとに分かれて定義されています．`include <ライブラリ名>` とすることでそのライブラリの機能を使えるようになります．`iostream` は標準入出力に関する機能がまとめられたライブラリであり，標準出力を意味する `std::cout`，改行を意味する `std::endl` などが定義されています．標準出力にメッセージを送る `<<` 演算子もここに定義されています．

標準ライブラリに含まれる機能を使うたびに `std::` を付けるのは面倒に感じるかもしれません．その場合，すべてのライブラリを `include` した後に `using namespace std;` と書くと，`std::` を省略して標準ライブラリの関数やクラスを直接使うことができます．例えば，Hello world! のプログラムを次のように書くことができます．

```c++
#include <iostream>
using namespace std;

int main() {
    cout << "Hello world!" << endl;
    return 0;
}
```

`using namespace std;` 使用にはいくつか注意点があります．

1. 名前の衝突: `using namespace std;` を使用すると、`std` 名前空間にあるすべての名前が現在のスコープに取り込まれます。これにより、他のライブラリやユーザー定義の名前と衝突する可能性があります。
2. 可読性の低下: `std::` を省略することでコードが短くなりますが、どの名前が標準ライブラリから来ているのかが不明確になるため、コードの可読性が低下することがあります。
3. 大規模なプロジェクト: 大規模なプロジェクトやライブラリでは、`using namespace std;` の使用を避けることが一般的です。これは、名前の衝突を避けるためと、コードの明確性を保つためです。

`using namespace std;` の使用は、小さなプログラムや学習目的のコードでは便利ですが、大規模なプロジェクトやライブラリでは慎重に検討する必要があります。必要な場合は、特定のクラスや関数に対して `using` 宣言を使うことで、名前空間を明示的に指定することができます。例えば、`using std::cout;` のように使用します。

## 文字列

文字列に関する機能は `string` ライブラリにまとめられています．

| 処理                             | コード                                             |
|----------------------------------|----------------------------------------------------|
| 宣言                             | `std::string str;`                                 |
| 2つの文字列を連結する           | `str1 + str2`                                      |
| 部分文字列を取り出す           | `str.substring(start, length)`                           |
| 文字列→`int` の変換             | `std::stoi(str)`                                   |
| 文字列→`double` の変換          | `std::stod(str)`                                   |
| 数値→文字列の変換               | `std::to_string(*)`                                |
| 行の読み込み                     | `std::getline(stream, buffer, delim='\n')`         |

基本的な使い方は次のとおりです．

```c++
#include <iostream>
#include <string>

int main()
{
    // 文字列の宣言
    std::string s = "Hello world!";

    // 部分文字列の抽出
    std::string substr1 = s.substr(0, 5);  // Hello
    std::string substr2 = s.substr(6, 5);  // world
    std::string substr3 = s.substr(11, 1); // !

    // 文字列の連結
    std::string new_str = substr1 + substr3; // Hello!
    std::cout << new_str << std::endl;

    return 0;
}
```

`getline` を使ってカンマで区切られた要素を取り出す

```c++
#include <iostream>
#include <string>
#include <sstream> // std::stringstream

int main() {
    std::string text = "123,456,789 ";
    std::stringstream ss(text);
    std::string element;
    int sum = 0;
    while (std::getline(ss, element, ','))
    {
        std::cout << element << std::endl;
        sum += std::stoi(element);
    }
    std::string message = "sum = " + std::to_string(sum);
    std::cout << message << std::endl;
    return 0;
}
// === 出力 ===
// 123
// 456
// 789
// sum = 1368
```

## ファイル入出力

ファイル入出力に関する機能は `fstream` ライブラリにまとめられています．

```c++
#include <string>
#include <iostream>
#include <fstream>

int main()
{
    // ファイル入力の例
    std::string input_path = "input.txt";
    std::ifstream ifs(input_path); // stream
    std::string line;              // buffer
    while (std::getline(ifs, line, '\n'))
        std::cout << line << std::endl;

    // ファイル出力の例
    std::string output_path = "output.txt";
    std::ofstream ofs(output_path);
    ofs << "Hello World!" << std::endl;
    return 0;
}
```

USD/JPY 過去データ(2024/03/18 ~ 2024/03/25) の終値

```txt
149.14
150.85
151.25
151.32
151.37
151.42
151.61
```
